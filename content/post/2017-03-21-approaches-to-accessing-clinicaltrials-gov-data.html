---
title: Approaches to accessing ClinicalTrials.gov data
author: Sean Davis
date: '2017-03-21'
topics:
  - R
  - software
tags:
  - clinicaltrials.gov
  - medical informatics
  - open data
---



<p>I have been attending the biannual Clinical Informatics for Cancer Centers (CI4CC) conference and there has been a fair amount of dicussion of <a href="https://clinicaltrials.gov">ClinicalTrials.gov</a> as a resource for enhancing patient engagement, trial recruitment, and results reporting. There are a number of approaches to search and access in bulk ClinicalTrials.gov data. The ones that I address here are:</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://clinicaltrialsapi.cancer.gov">CTRP RESTful API</a>.</li>
<li>The <a href="https://clinicaltrials.gov/ct2/info/linking">ClinicalTrials.gov API</a>.</li>
<li>The <a href="http://aact.ctti-clinicaltrials.org/">Access to Aggregate Content of ClinicalTrials.gov (AACT) database</a>.</li>
<li>The <a href="https://opentrials.net/">OpenTrials</a> API.</li>
</ol>
<div id="the-ctrp-restful-api" class="section level2">
<h2>The CTRP RESTful API</h2>
<p>One of the original reasons for me to attend was to help run a hackathon centered around the newest incarnation of API to access ClinicalTrials.gov data. The details of the API are described in text at the <a href="https://clinicaltrialsapi.cancer.gov">API endpoint</a>. <a href="https://nodejs.org">Node.js</a>-based code for the server side is available at the <a href="https://github.com/NCIP/clinical-trials-search">GitHub repository</a>. In preparation for the workshop discussion, I prepared a <a href="https://github.com/seandavi/ClinicalTrialsAPI">client package using R, the ClinicalTrialsAPI package</a>. The RESTful API is very simple, so a quick code runthrough using the ClinicalTrialsAPI package will give a sense of the capabilities.</p>
<p>The package is available on GitHub and is MIT-licensed.</p>
<pre class="r"><code># devtools::install_github(&#39;seandavi/ClinicalTrialsAPI&#39;)
library(&#39;ClinicalTrialsAPI&#39;)</code></pre>
<p>After installing and loading the package, we can get a sense of the data available using a simple query. In the next code block, we are not</p>
<pre class="r"><code>res = ct_search()
trialresults = res$trials
str(trialresults[1],list.len=10)</code></pre>
<pre><code>## List of 1
##  $ :List of 47
##   ..$ nci_id                              : chr &quot;NCI-2014-01507&quot;
##   ..$ nct_id                              : chr &quot;NCT02201992&quot;
##   ..$ protocol_id                         : chr &quot;E4512&quot;
##   ..$ ccr_id                              : NULL
##   ..$ ctep_id                             : chr &quot;E4512&quot;
##   ..$ dcp_id                              : NULL
##   ..$ other_ids                           :List of 1
##   .. ..$ :List of 2
##   .. .. ..$ name : chr &quot;Study Protocol Other Identifier&quot;
##   .. .. ..$ value: chr &quot;E4512&quot;
##   ..$ associated_studies                  :List of 1
##   .. ..$ :List of 2
##   .. .. ..$ study_id     : chr &quot;NCI-2014-01509&quot;
##   .. .. ..$ study_id_type: chr &quot;NCI&quot;
##   ..$ amendment_date                      : chr &quot;2017-02-08T00:00:00&quot;
##   ..$ current_trial_status                : chr &quot;Active&quot;
##   .. [list output truncated]</code></pre>
<p>Filtering results is pretty straightforward, as only limited comparators are available (see <a href="https://clinicaltrialsapi.cancer.gov">docs</a> for details). The <code>fields()</code> function returns all fields and their types as a named character vector.</p>
<pre class="r"><code>head(fields())</code></pre>
<pre><code>## accepts_healthy_volunteers_indicator                              acronym 
##                             &quot;string&quot;                             &quot;string&quot; 
##                       amendment_date                       anatomic_sites 
##                               &quot;date&quot;                             &quot;string&quot; 
##                 arms.arm_description                        arms.arm_name 
##                             &quot;string&quot;                             &quot;string&quot;</code></pre>
<p>Some more advanced queries are available <a href="https://github.com/seandavi/ClinicalTrialsAPI">at the ClinicalTrialsAPI github repo</a>.</p>
</div>
<div id="the-clinicaltrials.gov-api" class="section level2">
<h2>The ClinicalTrials.gov API</h2>
<p>Described <a href=""></a>, this xml-based API is queriable using the <a href="https://github.com/sachsmc/rclinicaltrials">rclinicaltrials R package</a>.</p>
<pre class="r"><code># install.packages(&#39;rclinicaltrials&#39;)
library(&#39;rclinicaltrials&#39;)</code></pre>
<p>As a simple example query:</p>
<pre class="r"><code>z &lt;- clinicaltrials_search(query = &#39;lime+disease&#39;)
str(z)</code></pre>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ score               : chr  &quot;0.021164&quot; &quot;0.020352&quot; &quot;0.016587&quot; &quot;0.007387&quot; ...
##  $ nct_id              : chr  &quot;NCT01951924&quot; &quot;NCT01333202&quot; &quot;NCT03224416&quot; &quot;NCT01056133&quot; ...
##  $ url                 : chr  &quot;https://ClinicalTrials.gov/show/NCT01951924&quot; &quot;https://ClinicalTrials.gov/show/NCT01333202&quot; &quot;https://ClinicalTrials.gov/show/NCT03224416&quot; &quot;https://ClinicalTrials.gov/show/NCT01056133&quot; ...
##  $ title               : chr  &quot;LIME Study (LFB IVIg MMN Efficacy Study)&quot; &quot;Fresh Lime Alone for Smoking Cessation&quot; &quot;Individual and Contextual Factors That Influence Sexual Decisions&quot; &quot;Effect of Fish-oil on Non-alcoholic Steatohepatitis (NASH)&quot; ...
##  $ status.text         : chr  &quot;Completed&quot; &quot;Completed&quot; &quot;Recruiting&quot; &quot;Completed&quot; ...
##  $ condition_summary   : chr  &quot;Motor Neuron Disease&quot; &quot;Tobacco Use Disorder&quot; &quot;Binge Drinking; Unsafe Sex; HIV/AIDS; Sexually Transmitted Diseases&quot; &quot;Non-alcoholic Fatty Liver Disease; Non-alcoholic Steatohepatitis&quot; ...
##  $ intervention_summary: chr  &quot;Drug: Biological : I10E (Human normal Immunoglobulin for intravenous administration 100mg/mL); Drug: Biological&quot;| __truncated__ &quot;Other: Fresh lime&quot; &quot;Other: Alcohol Administration; Other: Placebo Alcohol Administration; Other: No Alcohol Administration&quot; &quot;Other: Omega-3 capsules-Fish Oil&quot; ...
##  $ last_changed        : chr  &quot;July 18, 2016&quot; &quot;April 8, 2011&quot; &quot;July 19, 2017&quot; &quot;May 10, 2016&quot; ...</code></pre>
<p>Counting records is a useful way to see the “scope” of a term in the ClinicalTrials.gov dtabase.</p>
<pre class="r"><code>clinicaltrials_count(query = &quot;myeloma&quot;)</code></pre>
<pre><code>## [1] 2333</code></pre>
<p>Terms can be combined either using <code>AND</code>, <code>OR</code>, and <code>NOT</code> in the text query. A character vector of search terms is also supported.</p>
<pre class="r"><code>clinicaltrials_count(query = c(&quot;type=Intr&quot;, &quot;cond=cancer&quot;))</code></pre>
<pre><code>## [1] 47780</code></pre>
<p>Getting bulk data from the API is possible using the <code>clinicaltrials_download</code> function.</p>
<pre class="r"><code>y &lt;- clinicaltrials_download(query = &#39;myeloma&#39;, count = 10, include_results = TRUE)
str(y,list.len=5)</code></pre>
<pre><code>## List of 2
##  $ study_information:List of 6
##   ..$ study_info   :&#39;data.frame&#39;:    10 obs. of  41 variables:
##   .. ..$ org_study_id                        : chr [1:10] &quot;J0997&quot; &quot;MMRF-11-001&quot; &quot;101565&quot; &quot;IUCRO-0498&quot; ...
##   .. ..$ nct_id                              : chr [1:10] &quot;NCT01045460&quot; &quot;NCT01454297&quot; &quot;NCT01410981&quot; &quot;NCT02212262&quot; ...
##   .. ..$ brief_title                         : chr [1:10] &quot;Trial of Activated Marrow Infiltrating Lymphocytes Alone or in Conjunction With an Allogeneic Granulocyte Macro&quot;| __truncated__ &quot;Relating Clinical Outcomes in Multiple Myeloma to Personal Assessment of Genetic Profile&quot; &quot;Prognostic Potential of Cell Surface Markers and Pim Kinases in Multiple Myeloma&quot; &quot;Role of Osteocytes in Myeloma Bone Disease&quot; ...
##   .. ..$ official_title                      : chr [1:10] &quot;Randomized Trial of Activated Marrow Infiltrating Lymphocytes Alone or in Conjunction With an Allogeneic GM-CSF&quot;| __truncated__ &quot;A Prospective, Longitudinal, Observational Study in Newly Diagnosed Multiple Myeloma (MM) Patients to Assess th&quot;| __truncated__ &quot;Prognostic Potential of Cell Surface Markers and Pim Kinases in Multiple Myeloma&quot; &quot;Role of Osteocytes in Myeloma Bone Disease&quot; ...
##   .. ..$ overall_status                      : chr [1:10] &quot;Active, not recruiting&quot; &quot;Active, not recruiting&quot; &quot;Unknown status&quot; &quot;Recruiting&quot; ...
##   .. .. [list output truncated]
##   ..$ locations    :&#39;data.frame&#39;:    81 obs. of  15 variables:
##   .. ..$ name                    : chr [1:81] &quot;Sidney Kimmel Comprehensive Cancer Center at Johns Hopkins&quot; &quot;Mayo Clinic Campus in Scottsdale, AZ&quot; &quot;UC San Diego Moores Cancer Center&quot; &quot;Sharp Health Care&quot; ...
##   .. ..$ address.city            : chr [1:81] &quot;Baltimore&quot; &quot;Scottsdale&quot; &quot;San Diego&quot; &quot;San Diego&quot; ...
##   .. ..$ address.state           : chr [1:81] &quot;Maryland&quot; &quot;Arizona&quot; &quot;California&quot; &quot;California&quot; ...
##   .. ..$ address.zip             : chr [1:81] &quot;21231&quot; &quot;85259&quot; &quot;92093&quot; &quot;92123&quot; ...
##   .. ..$ address.country         : chr [1:81] &quot;United States&quot; &quot;United States&quot; &quot;United States&quot; &quot;United States&quot; ...
##   .. .. [list output truncated]
##   ..$ arms         :&#39;data.frame&#39;:    14 obs. of  4 variables:
##   .. ..$ arm_group_label: chr [1:14] &quot;1&quot; &quot;2&quot; &quot;Newly diagnosed Multiple Myeloma&quot; &quot;Multiple Myeloma subjects with bone marrow aspirate/biopsy&quot; ...
##   .. ..$ arm_group_type : chr [1:14] &quot;Experimental&quot; &quot;Experimental&quot; NA NA ...
##   .. ..$ description    : chr [1:14] &quot;aMILs&quot; &quot;aMILs + allogeneic myeloma vaccine&quot; &quot;This is a prospective observational study in patients with symptomatic multiple myeloma who have not yet initia&quot;| __truncated__ &quot;All patients seen at MUSC with a diagnosis of multiple myeloma or possible multiple myeloma who undergo bone ma&quot;| __truncated__ ...
##   .. ..$ nct_id         : chr [1:14] &quot;NCT01045460&quot; &quot;NCT01045460&quot; &quot;NCT01454297&quot; &quot;NCT01410981&quot; ...
##   ..$ interventions:&#39;data.frame&#39;:    18 obs. of  8 variables:
##   .. ..$ intervention_type: chr [1:18] &quot;Biological&quot; &quot;Biological&quot; &quot;Other&quot; &quot;Drug&quot; ...
##   .. ..$ intervention_name: chr [1:18] &quot;aMILs&quot; &quot;Allogeneic Myeloma Vaccine&quot; &quot;oligosecretary&quot; &quot;Lenalidomide&quot; ...
##   .. ..$ description      : chr [1:18] &quot;Activated marrow infiltrating lymphocytes&quot; &quot;Allogeneic granulocyte macrophage colony-stimulating factor (GM-CSF)-based myeloma cellular vaccine&quot; &quot;not abvailable&quot; &quot;Dosage forms: 5, 10, 15 and 25 mg capsules. Patients will be continued on the same dose of lenalidomide as they&quot;| __truncated__ ...
##   .. ..$ arm_group_label  : chr [1:18] &quot;1&quot; &quot;2&quot; &quot;oligosecretary&quot; &quot;Myeloma Vaccine, Prevnar-13 Vaccine, &amp; Lenalidomide&quot; ...
##   .. ..$ arm_group_label.1: chr [1:18] &quot;2&quot; NA NA NA ...
##   .. .. [list output truncated]
##   ..$ outcomes     :&#39;data.frame&#39;:    34 obs. of  5 variables:
##   .. ..$ measure    : chr [1:34] &quot;Evaluate clinical efficacy of activated marrow infiltrating lymphocytes (aMILs) administered alone or in combin&quot;| __truncated__ &quot;Evaluate Progression-free Survival and Overall Survival&quot; &quot;Anti-tumor immune response&quot; &quot;The effect of aMILs on osteoclastogenesis&quot; ...
##   .. ..$ time_frame : chr [1:34] &quot;Days 60, 180, and 360&quot; &quot;Days 60, 180, and 360&quot; &quot;Days 60, 180, and 360&quot; &quot;Days 60, 180, and 360&quot; ...
##   .. ..$ description: chr [1:34] &quot;2.1.1 Evaluate Response Rates utilizing the Blade&#39; criteria\nComplete Response (CR) rate\nNear Complete Respons&quot;| __truncated__ &quot;Patients will be monitored for progression/relapse on Days 60, 180, and 360, and as clinically indicated. Follo&quot;| __truncated__ &quot;Evaluate tumor specific responses in blood and bone marrow\nExamine T cell responses to DC-pulsed myeloma cell &quot;| __truncated__ &quot;Parameters of bone turnover that will include:\nRANKL/OPG ratio\nSerum C Telopeptide levels\nbAlkaline phosphat&quot;| __truncated__ ...
##   .. ..$ type       : chr [1:34] &quot;primary_outcome&quot; &quot;secondary_outcome&quot; &quot;secondary_outcome&quot; &quot;secondary_outcome&quot; ...
##   .. ..$ nct_id     : chr [1:34] &quot;NCT01045460&quot; &quot;NCT01045460&quot; &quot;NCT01045460&quot; &quot;NCT01045460&quot; ...
##   .. [list output truncated]
##  $ study_results    :List of 3
##   ..$ participant_flow: NULL
##   ..$ baseline_data   : NULL
##   ..$ outcome_data    : NULL</code></pre>
<p>As with any client that access complicated data via an API, dealing with returned results can be challenging. To quote the package documentation:</p>
<blockquote>
<p>The data come from a relational database with lots of text fields, so it may take some effort to get the data into a flat format for analysis. For that reason, results come back from the clinicaltrials_download function as a list of dataframes. Each dataframe has a common key variable: nct_id. To merge dataframes, use this key. Otherwise, you can analyze the dataframes separately. They are organized into study information, locations, outcomes, interventions, results, and textblocks. Results, where available, is itself a list with three dataframes: participant flow, baseline data, and outcome data.</p>
</blockquote>
</div>
<div id="the-aact-database" class="section level2">
<h2>The AACT database</h2>
<p>The AACT database is a relationalized, open SQL database dump of the ClinicalTrials.gov dataset. The data are modeled as an <a href="https://s3.amazonaws.com/aact-prod/documentation/aact_schema.png">extended star schema</a>. An <a href="http://aact.ctti-clinicaltrials.org/data_dictionary">online data dictionary</a> is also available. Remarkably, the group who has developed this AACT database has exposed a public PostgreSQL database for the world to use. Of course, R speaks fluently to relational databases. A modern approach using R is to access such databases using the <a href="https://cran.r-project.org/package=dplyr"><code>dplyr</code></a>.</p>
<pre class="r"><code>library(dplyr)
library(RPostgreSQL)</code></pre>
<p>Connect to the database. The <a href="http://aact.ctti-clinicaltrials.org/connect">connection parameters below</a> should work, as this is a public instance.</p>
<pre class="r"><code>aact = src_postgres(dbname = &#39;aact&#39;,
                    host = &quot;aact-prod.cr4nrslb1lw7.us-east-1.rds.amazonaws.com&quot;,
                    user = &#39;aact&#39;,
                    password = &#39;aact&#39;)
show(aact)</code></pre>
<pre><code>## src:  postgres 9.5.4 [aact@aact-prod.cr4nrslb1lw7.us-east-1.rds.amazonaws.com:5432/aact]
## tbls: baseline_counts, baseline_measurements, brief_summaries,
##   browse_conditions, browse_interventions, calculated_values,
##   central_contacts, conditions, countries, design_group_interventions,
##   design_groups, design_outcomes, designs, detailed_descriptions,
##   drop_withdrawals, eligibilities, facilities, facility_contacts,
##   facility_investigators, id_information, intervention_other_names,
##   interventions, keywords, links, mesh_headings, mesh_terms, milestones,
##   outcome_analyses, outcome_analysis_groups, outcome_counts,
##   outcome_measurements, outcomes, overall_officials, participant_flows,
##   reported_events, responsible_parties, result_agreements,
##   result_contacts, result_groups, schema_migrations, sponsors, studies,
##   study_references</code></pre>
<p>Starting with the main table, <code>studies</code>, gives an example of the utility of SQL-based data dumps of complex datasets.</p>
<pre class="r"><code>study_tbl = tbl(src=aact, &#39;studies&#39;)
head(study_tbl,3)</code></pre>
<pre><code>## # Source:   lazy query [?? x 49]
## # Database: postgres 9.5.4
## #   [aact@aact-prod.cr4nrslb1lw7.us-east-1.rds.amazonaws.com:5432/aact]
##        nct_id                           nlm_download_date_description
##         &lt;chr&gt;                                                   &lt;chr&gt;
## 1 NCT03228433 ClinicalTrials.gov processed this data on July 24, 2017
## 2 NCT03228407 ClinicalTrials.gov processed this data on July 24, 2017
## 3 NCT03228394 ClinicalTrials.gov processed this data on July 24, 2017
## # ... with 47 more variables: first_received_date &lt;date&gt;,
## #   last_changed_date &lt;date&gt;, first_received_results_date &lt;date&gt;,
## #   received_results_disposit_date &lt;date&gt;, start_month_year &lt;chr&gt;,
## #   start_date_type &lt;chr&gt;, start_date &lt;date&gt;,
## #   verification_month_year &lt;chr&gt;, verification_date &lt;date&gt;,
## #   completion_month_year &lt;chr&gt;, completion_date_type &lt;chr&gt;,
## #   completion_date &lt;date&gt;, primary_completion_month_year &lt;chr&gt;,
## #   primary_completion_date_type &lt;chr&gt;, primary_completion_date &lt;date&gt;,
## #   target_duration &lt;chr&gt;, study_type &lt;chr&gt;, acronym &lt;chr&gt;,
## #   baseline_population &lt;chr&gt;, brief_title &lt;chr&gt;, official_title &lt;chr&gt;,
## #   overall_status &lt;chr&gt;, last_known_status &lt;chr&gt;, phase &lt;chr&gt;,
## #   enrollment &lt;int&gt;, enrollment_type &lt;chr&gt;, source &lt;chr&gt;,
## #   limitations_and_caveats &lt;chr&gt;, number_of_arms &lt;int&gt;,
## #   number_of_groups &lt;int&gt;, why_stopped &lt;chr&gt;, has_expanded_access &lt;lgl&gt;,
## #   expanded_access_type_individual &lt;lgl&gt;,
## #   expanded_access_type_intermediate &lt;lgl&gt;,
## #   expanded_access_type_treatment &lt;lgl&gt;, has_dmc &lt;lgl&gt;,
## #   is_fda_regulated_drug &lt;lgl&gt;, is_fda_regulated_device &lt;lgl&gt;,
## #   is_unapproved_device &lt;lgl&gt;, is_ppsd &lt;lgl&gt;, is_us_export &lt;lgl&gt;,
## #   biospec_retention &lt;chr&gt;, biospec_description &lt;chr&gt;,
## #   plan_to_share_ipd &lt;chr&gt;, plan_to_share_ipd_description &lt;chr&gt;,
## #   created_at &lt;dttm&gt;, updated_at &lt;dttm&gt;</code></pre>
<p>Find the available study types.</p>
<pre class="r"><code>study_tbl %&gt;% select(study_type) %&gt;%
    group_by(study_type) %&gt;% summarize(count = n()) %&gt;%
    collect()</code></pre>
<pre><code>## # A tibble: 5 x 2
##                         study_type  count
## *                            &lt;chr&gt;  &lt;dbl&gt;
## 1                              N/A    720
## 2                   Interventional 201058
## 3                    Observational  46138
## 4 Observational [Patient Registry]   3169
## 5                  Expanded Access    438</code></pre>
<p>Filter queries (SQL “LIKE” query) are straightforward.</p>
<pre class="r"><code>x  = study_tbl %&gt;% filter(official_title %like% &#39;%TP53%&#39;) %&gt;% collect()
dim(x)</code></pre>
<pre><code>## [1] 16 49</code></pre>
<pre class="r"><code>x$official_title[1:3]</code></pre>
<pre><code>## [1] &quot;A Prospective, Multicenter, Phase-II Trial of Ibrutinib Plus Venetoclax in Patients With Creatinine Clearance &gt;= 30 ml/Min Who Have Relapsed or Refractory Chronic Lymphocytic Leukemia (RR-CLL) With or Without TP53 Aberrations&quot;
## [2] &quot;Treatment of Patients With Metastatic Colorectal Cancer Harboring TP53 Mutations With Dose-dense Cyclophosphamide - the p53 Colorectal Cancer Trial&quot;                                                                              
## [3] &quot;A Phase 1b/2 Study to Evaluate the Safety and Efficacy of APR-246 in Combination With Azacitidine for the Treatment of TP53 Mutant Myeloid Neoplasms&quot;</code></pre>
</div>
<div id="opentrials.net" class="section level2">
<h2>OpenTrials.net</h2>
<p>Rather than trying to address this one directly, I refer to an <a href="https://bergant.github.io/OpenTrialsRDemo/">available tutorial</a>.</p>
</div>
<div id="provenance" class="section level2">
<h2>Provenance</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.4.1 (2017-06-30)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Sierra 10.12.4
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
## [1] RPostgreSQL_0.6-2       DBI_0.7                 dplyr_0.7.2            
## [4] rclinicaltrials_1.4.7   ClinicalTrialsAPI_0.1.0 magrittr_1.5           
## [7] knitr_1.17             
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.12     bindr_0.1        R6_2.2.2         rlang_0.1.2     
##  [5] stringr_1.2.0    httr_1.2.1       plyr_1.8.4       tools_3.4.1     
##  [9] dbplyr_1.1.0     htmltools_0.3.6  yaml_2.1.14      rprojroot_1.2   
## [13] digest_0.6.12    assertthat_0.2.0 tibble_1.3.3     bookdown_0.5    
## [17] bindrcpp_0.2     codetools_0.2-15 curl_2.8.1       glue_1.1.1      
## [21] evaluate_0.10.1  rmarkdown_1.6    blogdown_0.0.72  stringi_1.1.5   
## [25] compiler_3.4.1   backports_1.1.0  XML_3.98-1.9     jsonlite_1.5    
## [29] pkgconfig_2.0.1</code></pre>
</div>
