<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.27.1" />

  <title>Extracting Clinical Information Using the Genomicdatacommons Package &middot; seandavi(s12)</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/zenburn.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://seandavi.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">seandavi(s12)</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/talk/"><i class='fa fa-microphone fa-fw'></i>Talks</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/publication/"><i class='fa fa-file-text fa-fw'></i>Publications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">
      
    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://scholar.google.com/citations?user=hLFc29kAAAAJ"><i class="fa fa-graduation-cap fa-fw"></i>Scholar</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/seandavis12" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/seandavi" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://bitbucket.org/seandavi" target="_blank"><i class="fa fa-bitbucket-square fa-fw"></i>Bitbucket</a>
    </li>
    

    

    


    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/seandavi" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/seandavi" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    


    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017 Sean Davis</small>
  </div>
  <div class="small-print">
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Extracting Clinical Information Using the Genomicdatacommons Package</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Mar 2018</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://seandavi.github.io/tags/cancer-genomics">Cancer Genomics</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://seandavi.github.io/tags/genomicdatacommons">GenomicDataCommons</a>
    
  </div>
  
  

</div>

  <p>This short post introducds the <code>gdc_clinical()</code> function recently added to the GenomicDataCommons package.</p>
<p>The <a href="https://gdc.cancer.gov/developers/gdc-data-model">rich data model</a> at the NCI Genomic Data Commons (GDC) includes clinical and biospecimen details. A recently added feature to the NCI GDC Data Portal is the ability to download tab-delimited files or JSON files for clinical and biospecimen details of samples. The details available in these simplified formats are also available via the GDC API.</p>
<pre class="r"><code>library(GenomicDataCommons)</code></pre>
<p>The clinical infomation at the GDC is encapsulated in the <code>cases</code> records. Here, I introduce the <code>gdc_clinical()</code> function from the <a href="https://bioconductor.org/packages/GenomicDataCommons">GenomicDataCommons</a> package that takes as input GDC case IDs and returns a set of four related <code>data.frame</code>s:</p>
<ul>
<li>main: important case metadata</li>
<li>demographics: basic demographic information</li>
<li>exposures: zero or more documented exposures</li>
<li>diagnoses: zero or more diagnoses per case</li>
</ul>
<p>As an example application, we will examine the clinical details for 100 lung adenocarcinoma patients from TCGA (“TCGA-LUAD”). The case ids are available through a basic <code>cases()</code> query, <code>filter</code>ed to include only samples that belong to the project from <code>TCGA-LUAD</code> (stored in the <code>project.project_id</code> field). The query to get these case_ids, then, looks like:</p>
<pre class="r"><code>case_ids = cases() %&gt;%
    filter(~ project.project_id == &#39;TCGA-LUAD&#39;) %&gt;%
    results(size=100) %&gt;%
    ids()
head(case_ids)</code></pre>
<pre><code>## [1] &quot;a41c46da-7ed4-4192-bd16-b3cbb94a5133&quot;
## [2] &quot;ad74c0e8-8878-4efc-997d-981cd547bc5b&quot;
## [3] &quot;807cc7d2-6e3b-4f2d-9531-0da994eeeada&quot;
## [4] &quot;77bb204d-4e68-4c93-905f-9ef4c53b1ce2&quot;
## [5] &quot;0d96def2-cf0a-4659-94e5-f08744c57cc6&quot;
## [6] &quot;9e640ff7-996e-427b-b56c-519a1e23baab&quot;</code></pre>
<p>These case_ids, each representing a single case (patient) in the GDC, can be be fed directly to <code>gdc_clinical</code>.</p>
<pre class="r"><code>clin_res = gdc_clinical(case_ids)</code></pre>
<p>The result is a list of data.frames:</p>
<pre class="r"><code>names(clin_res)</code></pre>
<pre><code>## [1] &quot;demographic&quot; &quot;diagnoses&quot;   &quot;exposures&quot;   &quot;main&quot;</code></pre>
<p>The the dimensions of these data.frames is instructive.</p>
<pre class="r"><code>sapply(clin_res, dim) %&gt;%
    t() %&gt;%
    data.frame() %&gt;%
    set_names(c(&#39;rows&#39;,&#39;columns&#39;))</code></pre>
<pre><code>##             rows columns
## demographic  100      11
## diagnoses     83      23
## exposures     83      13
## main         100       8</code></pre>
<p>And the column names for each are helpful to examine:</p>
<pre class="r"><code>sapply(clin_res, colnames)</code></pre>
<pre><code>## $demographic
##  [1] &quot;updated_datetime&quot; &quot;created_datetime&quot; &quot;gender&quot;          
##  [4] &quot;year_of_birth&quot;    &quot;submitter_id&quot;     &quot;state&quot;           
##  [7] &quot;race&quot;             &quot;demographic_id&quot;   &quot;ethnicity&quot;       
## [10] &quot;year_of_death&quot;    &quot;case_id&quot;         
## 
## $diagnoses
##  [1] &quot;case_id&quot;                          
##  [2] &quot;classification_of_tumor&quot;          
##  [3] &quot;last_known_disease_status&quot;        
##  [4] &quot;updated_datetime&quot;                 
##  [5] &quot;primary_diagnosis&quot;                
##  [6] &quot;submitter_id&quot;                     
##  [7] &quot;tumor_stage&quot;                      
##  [8] &quot;age_at_diagnosis&quot;                 
##  [9] &quot;vital_status&quot;                     
## [10] &quot;morphology&quot;                       
## [11] &quot;days_to_death&quot;                    
## [12] &quot;days_to_last_known_disease_status&quot;
## [13] &quot;created_datetime&quot;                 
## [14] &quot;state&quot;                            
## [15] &quot;days_to_recurrence&quot;               
## [16] &quot;diagnosis_id&quot;                     
## [17] &quot;tumor_grade&quot;                      
## [18] &quot;tissue_or_organ_of_origin&quot;        
## [19] &quot;days_to_birth&quot;                    
## [20] &quot;progression_or_recurrence&quot;        
## [21] &quot;prior_malignancy&quot;                 
## [22] &quot;site_of_resection_or_biopsy&quot;      
## [23] &quot;days_to_last_follow_up&quot;           
## 
## $exposures
##  [1] &quot;case_id&quot;            &quot;cigarettes_per_day&quot; &quot;weight&quot;            
##  [4] &quot;updated_datetime&quot;   &quot;alcohol_history&quot;    &quot;alcohol_intensity&quot; 
##  [7] &quot;bmi&quot;                &quot;years_smoked&quot;       &quot;submitter_id&quot;      
## [10] &quot;created_datetime&quot;   &quot;state&quot;              &quot;exposure_id&quot;       
## [13] &quot;height&quot;            
## 
## $main
## [1] &quot;updated_datetime&quot; &quot;submitter_id&quot;     &quot;case_id&quot;         
## [4] &quot;id&quot;               &quot;disease_type&quot;     &quot;created_datetime&quot;
## [7] &quot;state&quot;            &quot;primary_site&quot;</code></pre>
<p>Note the each data.frame contains a <code>case_id</code> column by design to allow arbitrary joining of the tables to each other. In this case, the data relationships are not too complicated, but one might imagine situations arising that include many-to-many relationships that are hard to handle in a fully general way without some understanding of downstream use (what do we want to do with the clinical information?). In this relatively simple case, we can create a “master” data.frame by joining all the records from each data.frame.</p>
<pre class="r"><code>library(dplyr)
full_clin = with(clin_res,
     main %&gt;%
     left_join(demographic, by = &quot;case_id&quot;) %&gt;%
     left_join(exposures, by = &quot;case_id&quot;) %&gt;%
     left_join(diagnoses, by = &quot;case_id&quot;))</code></pre>
<p>Above, I have used the tidyverse approach, applying <code>dplyr</code> <code>left_join()</code>s. Using base R <code>merge</code> would also work.</p>
<pre class="r"><code>dim(full_clin)</code></pre>
<pre><code>## [1] 100  52</code></pre>
<pre class="r"><code>colnames(full_clin)</code></pre>
<pre><code>##  [1] &quot;updated_datetime.x&quot;               
##  [2] &quot;submitter_id.x&quot;                   
##  [3] &quot;case_id&quot;                          
##  [4] &quot;id&quot;                               
##  [5] &quot;disease_type&quot;                     
##  [6] &quot;created_datetime.x&quot;               
##  [7] &quot;state.x&quot;                          
##  [8] &quot;primary_site&quot;                     
##  [9] &quot;updated_datetime.y&quot;               
## [10] &quot;created_datetime.y&quot;               
## [11] &quot;gender&quot;                           
## [12] &quot;year_of_birth&quot;                    
## [13] &quot;submitter_id.y&quot;                   
## [14] &quot;state.y&quot;                          
## [15] &quot;race&quot;                             
## [16] &quot;demographic_id&quot;                   
## [17] &quot;ethnicity&quot;                        
## [18] &quot;year_of_death&quot;                    
## [19] &quot;cigarettes_per_day&quot;               
## [20] &quot;weight&quot;                           
## [21] &quot;updated_datetime.x.x&quot;             
## [22] &quot;alcohol_history&quot;                  
## [23] &quot;alcohol_intensity&quot;                
## [24] &quot;bmi&quot;                              
## [25] &quot;years_smoked&quot;                     
## [26] &quot;submitter_id.x.x&quot;                 
## [27] &quot;created_datetime.x.x&quot;             
## [28] &quot;state.x.x&quot;                        
## [29] &quot;exposure_id&quot;                      
## [30] &quot;height&quot;                           
## [31] &quot;classification_of_tumor&quot;          
## [32] &quot;last_known_disease_status&quot;        
## [33] &quot;updated_datetime.y.y&quot;             
## [34] &quot;primary_diagnosis&quot;                
## [35] &quot;submitter_id.y.y&quot;                 
## [36] &quot;tumor_stage&quot;                      
## [37] &quot;age_at_diagnosis&quot;                 
## [38] &quot;vital_status&quot;                     
## [39] &quot;morphology&quot;                       
## [40] &quot;days_to_death&quot;                    
## [41] &quot;days_to_last_known_disease_status&quot;
## [42] &quot;created_datetime.y.y&quot;             
## [43] &quot;state.y.y&quot;                        
## [44] &quot;days_to_recurrence&quot;               
## [45] &quot;diagnosis_id&quot;                     
## [46] &quot;tumor_grade&quot;                      
## [47] &quot;tissue_or_organ_of_origin&quot;        
## [48] &quot;days_to_birth&quot;                    
## [49] &quot;progression_or_recurrence&quot;        
## [50] &quot;prior_malignancy&quot;                 
## [51] &quot;site_of_resection_or_biopsy&quot;      
## [52] &quot;days_to_last_follow_up&quot;</code></pre>
<p>In conclusion, the <code>gdc_clinical</code> functionality from the GenomicDataCommons is a high-level function for capturing unified and harmonized clinical information for <em>any</em> case in the NCI GDC repository.</p>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R Under development (unstable) (2017-11-02 r73659)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Sierra 10.12.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] methods   stats     graphics  grDevices utils     datasets  base     
## 
## other attached packages:
## [1] dplyr_0.7.4              GenomicDataCommons_1.3.4
## [3] magrittr_1.5             knitr_1.20              
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.16           compiler_3.5.0         pillar_1.1.0          
##  [4] GenomeInfoDb_1.15.5    XVector_0.19.8         bindr_0.1             
##  [7] bitops_1.0-6           tools_3.5.0            zlibbioc_1.25.0       
## [10] digest_0.6.15          jsonlite_1.5           evaluate_0.10.1       
## [13] tibble_1.4.2           pkgconfig_2.0.1        rlang_0.2.0           
## [16] yaml_2.1.18            parallel_3.5.0         blogdown_0.5.12       
## [19] xfun_0.1               bindrcpp_0.2           GenomeInfoDbData_1.1.0
## [22] xml2_1.1.1             stringr_1.3.0          httr_1.3.1            
## [25] hms_0.4.1              rappdirs_0.3.1         S4Vectors_0.17.33     
## [28] IRanges_2.13.26        stats4_3.5.0           rprojroot_1.3-2       
## [31] glue_1.2.0             R6_2.2.2               rmarkdown_1.9         
## [34] bookdown_0.7           readr_1.1.1            backports_1.1.2       
## [37] htmltools_0.3.6        BiocGenerics_0.25.3    GenomicRanges_1.31.22 
## [40] assertthat_0.2.0       stringi_1.1.6          RCurl_1.95-4.8        
## [43] lazyeval_0.2.1</code></pre>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://seandavi.github.io/post/2018/02/create-a-basic-apache-spark-cluster-in-the-cloud-in-5-minutes/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://seandavi.github.io/post/2018/02/create-a-basic-apache-spark-cluster-in-the-cloud-in-5-minutes/">Create a basic Apache Spark cluster in the cloud (in 5 minutes)</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'seandavi-github-io';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

</div>
</div>
<script src="https://seandavi.github.io/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-93043521-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

