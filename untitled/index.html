<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.27.1" />

  <title> &middot; seandavi(s12)</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/zenburn.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://seandavi.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">seandavi(s12)</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/talk/"><i class='fa fa-microphone fa-fw'></i>Talks</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/publication/"><i class='fa fa-file-text fa-fw'></i>Publications</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">
      
    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://scholar.google.com/citations?user=hLFc29kAAAAJ"><i class="fa fa-graduation-cap fa-fw"></i>Scholar</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/seandavis12" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/seandavi" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://bitbucket.org/seandavi" target="_blank"><i class="fa fa-bitbucket-square fa-fw"></i>Bitbucket</a>
    </li>
    

    

    


    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/seandavi" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/seandavi" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    


    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017 Sean Davis</small>
  </div>
  <div class="small-print">
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1></h1>
  <h2></h2>
</div>
<div class="content">
  

<h1 id="testing">testing</h1>

<p>This is some test text to see how things look.</p>

<pre><code class="language-python">import os
os.environ['PYSPARK_SUBMIT_ARGS'] = '--jars /tmp/spark-xml/target/scala-2.11/spark-xml_2.11-0.4.1.jar pyspark-shell'
import pyspark
</code></pre>

<pre><code class="language-python">sc = pyspark.SparkContext()
</code></pre>

<pre><code class="language-python">from pyspark.sql import SQLContext
sqlContext = SQLContext(sc)

df = sqlContext.read.format('com.databricks.spark.xml').options(rowTag='RUN').load('/tmp/NCBI_SRA_Metadata_Full_20170902/SRA00001*/*.run.xml')
</code></pre>

<pre><code class="language-python">df.cache()
</code></pre>

<pre><code>DataFrame[EXPERIMENT_REF: struct&lt;IDENTIFIERS:struct&lt;PRIMARY_ID:string,SUBMITTER_ID:struct&lt;_VALUE:string,_namespace:string&gt;&gt;,_accession:string,_refname:string&gt;, IDENTIFIERS: struct&lt;PRIMARY_ID:string,SUBMITTER_ID:struct&lt;_VALUE:string,_namespace:string&gt;&gt;, RUN_ATTRIBUTES: struct&lt;RUN_ATTRIBUTE:array&lt;struct&lt;TAG:string,VALUE:string&gt;&gt;&gt;, SPOT_DESCRIPTOR: struct&lt;SPOT_DECODE_SPEC:struct&lt;READ_SPEC:array&lt;struct&lt;BASE_COORD:bigint,EXPECTED_BASECALL_TABLE:struct&lt;BASECALL:string&gt;,READ_CLASS:string,READ_INDEX:bigint,READ_TYPE:string&gt;&gt;&gt;&gt;, _accession: string, _alias: string, _center_name: string, _run_center: string, _run_date: string]
</code></pre>

<pre><code class="language-python">df.show()
</code></pre>

<pre><code>+--------------------+--------------------+--------------------+--------------------+----------+-------+------------+-----------+--------------------+
|      EXPERIMENT_REF|         IDENTIFIERS|      RUN_ATTRIBUTES|     SPOT_DESCRIPTOR|_accession| _alias|_center_name|_run_center|           _run_date|
+--------------------+--------------------+--------------------+--------------------+----------+-------+------------+-----------+--------------------+
|[[SRX000072,[4WG_...|[SRR000300,[D7GOF...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000300|D7GOF0U|         BCM|        BCM|2006-07-24T11:02:00Z|
|[[SRX000074,[4WG_...|[SRR000301,[EKQR3...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000301|EKQR3W3|         BCM|        BCM|2007-02-26T16:58:00Z|
|[[SRX000073,[4WG_...|[SRR000302,[EL2GY...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000302|EL2GY2J|         BCM|        BCM|2007-03-20T10:16:00Z|
|[[SRX000077,[4WG_...|[SRR000306,[EL4MF...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000306|EL4MFYP|         BCM|        BCM|2007-03-21T13:36:00Z|
|[[SRX000078,[4WG_...|[SRR000307,[ELIJ3...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000307|ELIJ30T|         BCM|        BCM|2007-03-09T16:02:00Z|
|[[SRX000077,[4WG_...|[SRR000308,[EMK67...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000308|EMK67XI|         BCM|        BCM|2007-03-30T12:59:00Z|
|[[SRX000075,[4WG_...|[SRR000303,[EL6FY...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000303|EL6FY9P|         BCM|        BCM|2007-03-22T13:11:00Z|
|[[SRX000076,[4WG_...|[SRR000304,[ELC0N...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000304|ELC0N5B|         BCM|        BCM|2007-03-06T16:07:00Z|
|[[SRX000076,[4WG_...|[SRR000305,[ELPST...|[WrappedArray([fl...|[[WrappedArray([1...| SRR000305|ELPST1P|         BCM|        BCM|2007-03-13T13:39:00Z|
+--------------------+--------------------+--------------------+--------------------+----------+-------+------------+-----------+--------------------+
</code></pre>

<pre><code class="language-python">df.schema
</code></pre>

<pre><code>StructType(List(StructField(EXPERIMENT_REF,StructType(List(StructField(IDENTIFIERS,StructType(List(StructField(PRIMARY_ID,StringType,true),StructField(SUBMITTER_ID,StructType(List(StructField(_VALUE,StringType,true),StructField(_namespace,StringType,true))),true))),true),StructField(_accession,StringType,true),StructField(_refname,StringType,true))),true),StructField(IDENTIFIERS,StructType(List(StructField(PRIMARY_ID,StringType,true),StructField(SUBMITTER_ID,StructType(List(StructField(_VALUE,StringType,true),StructField(_namespace,StringType,true))),true))),true),StructField(RUN_ATTRIBUTES,StructType(List(StructField(RUN_ATTRIBUTE,ArrayType(StructType(List(StructField(TAG,StringType,true),StructField(VALUE,StringType,true))),true),true))),true),StructField(SPOT_DESCRIPTOR,StructType(List(StructField(SPOT_DECODE_SPEC,StructType(List(StructField(READ_SPEC,ArrayType(StructType(List(StructField(BASE_COORD,LongType,true),StructField(EXPECTED_BASECALL_TABLE,StructType(List(StructField(BASECALL,StringType,true))),true),StructField(READ_CLASS,StringType,true),StructField(READ_INDEX,LongType,true),StructField(READ_TYPE,StringType,true))),true),true))),true))),true),StructField(_accession,StringType,true),StructField(_alias,StringType,true),StructField(_center_name,StringType,true),StructField(_run_center,StringType,true),StructField(_run_date,StringType,true)))
</code></pre>

<pre><code class="language-python">df.printSchema()
</code></pre>

<pre><code>root
 |-- EXPERIMENT_REF: struct (nullable = true)
 |    |-- IDENTIFIERS: struct (nullable = true)
 |    |    |-- PRIMARY_ID: string (nullable = true)
 |    |    |-- SUBMITTER_ID: struct (nullable = true)
 |    |    |    |-- _VALUE: string (nullable = true)
 |    |    |    |-- _namespace: string (nullable = true)
 |    |-- _accession: string (nullable = true)
 |    |-- _refname: string (nullable = true)
 |-- IDENTIFIERS: struct (nullable = true)
 |    |-- PRIMARY_ID: string (nullable = true)
 |    |-- SUBMITTER_ID: struct (nullable = true)
 |    |    |-- _VALUE: string (nullable = true)
 |    |    |-- _namespace: string (nullable = true)
 |-- RUN_ATTRIBUTES: struct (nullable = true)
 |    |-- RUN_ATTRIBUTE: array (nullable = true)
 |    |    |-- element: struct (containsNull = true)
 |    |    |    |-- TAG: string (nullable = true)
 |    |    |    |-- VALUE: string (nullable = true)
 |-- SPOT_DESCRIPTOR: struct (nullable = true)
 |    |-- SPOT_DECODE_SPEC: struct (nullable = true)
 |    |    |-- READ_SPEC: array (nullable = true)
 |    |    |    |-- element: struct (containsNull = true)
 |    |    |    |    |-- BASE_COORD: long (nullable = true)
 |    |    |    |    |-- EXPECTED_BASECALL_TABLE: struct (nullable = true)
 |    |    |    |    |    |-- BASECALL: string (nullable = true)
 |    |    |    |    |-- READ_CLASS: string (nullable = true)
 |    |    |    |    |-- READ_INDEX: long (nullable = true)
 |    |    |    |    |-- READ_TYPE: string (nullable = true)
 |-- _accession: string (nullable = true)
 |-- _alias: string (nullable = true)
 |-- _center_name: string (nullable = true)
 |-- _run_center: string (nullable = true)
 |-- _run_date: string (nullable = true)
</code></pre>

<pre><code class="language-python">df.select('EXPERIMENT_REF.IDENTIFIERS.PRIMARY_ID','IDENTIFIERS.PRIMARY_ID').show()
</code></pre>

<pre><code>+----------+----------+
|PRIMARY_ID|PRIMARY_ID|
+----------+----------+
| SRX000072| SRR000300|
| SRX000074| SRR000301|
| SRX000073| SRR000302|
| SRX000077| SRR000306|
| SRX000078| SRR000307|
| SRX000077| SRR000308|
| SRX000075| SRR000303|
| SRX000076| SRR000304|
| SRX000076| SRR000305|
+----------+----------+
</code></pre>

<pre><code class="language-python">
</code></pre>

</div>

</div>
</div>
<script src="https://seandavi.github.io/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-93043521-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

